(function () {
    'use strict';

    function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,c=[],l=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1;}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,i=e;}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return c}}function _typeof(e){return (_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,r){return (t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return "Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(e,t){var r,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),r=0,{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return {s:function(){n=n.call(e);},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,i=e;},f:function(){try{o||null==n.return||n.return();}finally{if(a)throw i}}}}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toPropertyKey(e){e=_toPrimitive(e,"string");return "symbol"==typeof e?e:String(e)}function isStringTemplateArray(e){return e instanceof Array&&e.raw instanceof Array}var AlinsType,OprateType,type=Symbol("t"),util=Symbol("u"),empty=Symbol("e"),trig=Symbol("t"),pureproxy=Symbol("pp");function proxyItem(r,e,n){return r[util].shallow?e:e.map(function(e,t){return e&&"object"===_typeof(e)?createProxy(e,{commonLns:r[util].commonLns,path:r[util].path,key:"".concat(n+t)}):e})}function triggerOprationEvent(e,t,r,n,i,o){null!=(e=e[trig])&&e.forEach(function(e){e({type:t,data:n,index:r,count:i,fromAssign:o});});}function wrapArrayCall(e,t){e[util].replaceLns=!1;t=t();return delete e[util].replaceLns,t}!function(e){e[e.ElementBuilder=1]="ElementBuilder",e[e.Element=2]="Element",e[e.TextNode=3]="TextNode",e[e.Proxy=4]="Proxy",e[e.Ref=5]="Ref",e[e.BindResult=6]="BindResult",e[e.If=7]="If",e[e.Switch=8]="Switch";}(AlinsType=AlinsType||{}),function(e){e[e.Replace=0]="Replace",e[e.Remove=1]="Remove",e[e.Insert=2]="Insert",e[e.Push=3]="Push",e[e.Sort=4]="Sort";}(OprateType=OprateType||{});var ArrayMap={splice:function(e,t){var r=this.target,n=this.origin;e>=r.length?(e=r.length,t=0):(void 0===t||e+t>r.length)&&(t=r.length-e);for(var i=arguments.length,o=new Array(2<i?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];var c=o.length,l=Math.min(t,c),u=e+l;t<c?(l=proxyItem(r,o.slice(l),u),triggerOprationEvent(r,OprateType.Insert,u,l,l.length)):(l=t-c,triggerOprationEvent(r,OprateType.Remove,u,r.slice(u,u+l),l));for(var f=e;f<u;f++){var s=o[f-e];triggerOprationEvent(r,OprateType.Replace,f,[s,r[f]],1);}var p=r[util].scopeItems,y=null==p?void 0:p.slice(e,e+o.length).map(function(e){return e[p.key].v});return wrapArrayCall(r,function(){return n.call.apply(n,[r[util].proxy,e,t].concat(_toConsumableArray(y)))})},push:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=this.target,i=this.origin,t=proxyItem(n,t,n.length);return triggerOprationEvent(n,OprateType.Push,n.length,t,t.length),i.call.apply(i,[n[util].proxy].concat(_toConsumableArray(t)))},pop:function(){var e=this.target,t=this.origin;return 0<e.length&&triggerOprationEvent(e,OprateType.Remove,e.length-1,[e[e.length-1]],1),t.call(e[util].proxy)},unshift:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=this.target,i=this.origin,t=proxyItem(n,t,0);return triggerOprationEvent(n,OprateType.Insert,0,t,t.length),wrapArrayCall(n,function(){return i.call.apply(i,[n[util].proxy].concat(_toConsumableArray(t)))})},shift:function(){var e=this.target,t=this.origin;return 0<e.length&&triggerOprationEvent(e,OprateType.Remove,0,e[0],1),t.call(e[util].proxy)},replace:function(e,t,r,n){triggerOprationEvent(e,OprateType.Replace,t,[n,r],1),e[t]=n;}},mapFunc={};function registArrayMap(e){mapFunc.map=e;}function arrayFuncProxy(e,t,r){return ArrayMap[t]&&e[trig]&&!e[t].hack?(e[t]=ArrayMap[t].bind({target:e,origin:e[t]}),e[t].hack=!0,e[t]):mapFunc[t]?mapFunc[t].bind(e):Reflect.get(e,t,r)}function replaceArrayItem(e,t,r){return e[trig]?(ArrayMap.replace(e,parseInt(t),e[t],r),!0):empty}var currentFn=null,depReactive=!1;function isDepReactive(){return depReactive}function observe(e){currentFn=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,depReactive=!1;var t=e();return currentFn=null,t}function isRef(e){return (null==e?void 0:e[type])===AlinsType.Ref}function isProxy(e){e=null==e?void 0:e[type];return e===AlinsType.Proxy||e===AlinsType.Ref}function wrapReactive(e){return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]||!e||"object"!==_typeof(e)?_defineProperty({v:e},type,AlinsType.Ref):e}function createUtils(a,t,e){function r(t,r,n,i,e){function o(e){e(r,n,"".concat(c.join("."),".").concat(t),t,i);}e&&null!=(e=a[util].commonLns)&&e.forEach(o),null!=(e=a[util].lns[t])&&e.forEach(o),null!=(e=a[util].extraLns)&&e.forEach(function(e){null!=(e=e[t])&&e.forEach(o);});}var c=t?[].concat(_toConsumableArray(e),[t]):_toConsumableArray(e),e=Array.isArray(a);a[util].commonLns&&(a[util].lns[t]=new Set,a[util].commonLns.forEach(function(e){a[util].lns[t].add(e);})),Object.assign(a[util],{path:c,triggerChange:r,forceWrite:function(e){for(var t in e)r(t,e[t],a[t]);Object.assign(a,e);},subscribe:function(e){var t,r,n,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];for(n in null!=(t=a[util].commonLns)&&t.add(e)||(a[util].commonLns=new Set([e])),a)null!=(r=a[util].lns[n])&&r.add(e)||(a[util].lns[n]=new Set([e])),i&&isProxy(a[n])&&a[n][util].subscribe(e,i);},isArray:e,forceUpdate:function(){for(var e in a)r(e,a[e],a[e]);}});}function createProxy(c){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=e.commonLns,r=e.lns,i=void 0===r?{}:r,r=e.shallow,l=void 0!==r&&r,u=e.set,o=e.get,r=e.path,f=void 0===r?[]:r,r=e.key,e=void 0===r?"":r;if(c[type]||(c[type]=AlinsType.Proxy),!l)for(var n in c){var a=c[n];if(a&&"object"===_typeof(a))try{c[n]=createProxy(a,{path:f,key:n});}catch(e){}}c[util]={commonLns:t,lns:i,shallow:l},createUtils(c,e,f);var r=c[util],s=r.triggerChange,p=r.isArray,t=new Proxy(c,{get:function(e,t,r){var n="function"==typeof e[t];if(p&&n)return arrayFuncProxy(e,t,r);if("symbol"===_typeof(t)||n){if(t===pureproxy)return !0}else {if(currentFn)return depReactive=depReactive||!0,null!=(n=i[t])&&n.add(currentFn)||(i[t]=new Set([currentFn])),Reflect.get(e,t,r);if("v"===t&&o)return o()}return Reflect.get(e,t,r)},set:function(e,t,r,n){if("symbol"===_typeof(t)||"function"==typeof e[t])return Reflect.set(e,t,r,n);var i=e[t];if(r===i&&(null==(a=e[util])||!a._map))return !0;if(null===u)return console.warn("Computed 不可设置"),!0;if("v"===t&&u)return u(r,i,"".concat(f.join("."),".").concat(t),t),!0;r&&"object"===_typeof(r)&&!l&&(isProxy(r)?(r[pureproxy]||(r=r[util].proxy),isProxy(i)&&!1!==c[util].replaceLns&&replaceLNS(r,i)):(i&&(i[util].removed=!0),r=createProxy(r,{commonLns:e[util].commonLns,lns:null==i?void 0:i[util].lns,shallow:l,path:f,key:t})));var o,a=empty;return p&&/^\d+$/.test(t)&&((o=replaceArrayItem(e,t,r))!==empty&&(a=o)),a===empty&&(a=Reflect.set(e,t,r,n)),s(t,r,i,!1,void 0===i),a},deleteProperty:function(e,t){return s(t,void 0,e[t],!0),Reflect.deleteProperty(e,t)}});return c[util].proxy=t}function replaceLNS(e,t){var r,n,i=e[util],o=t[util];for(n in o.extraLns&&o.extraLns.has(i.lns)?(r=i.lns,i.lns=o.lns,o.lns=r,o.extraLns.delete(r)):i.extraLns?i.extraLns.add(o.lns):i.extraLns=new Set([o.lns]),e)isProxy(e[n])&&isProxy(t[n])&&replaceLNS(e[n],t[n]);}function computed(e){var t,r="function"==typeof e,n=r?e:e.get,r=r?null:e.set,e=observe(n,function(){t[util].forceWrite(wrapReactive(n(),!0));});return isDepReactive()?t=createProxy(wrapReactive(e,!0),{set:r,get:n}):{v:e}}function isValueEqual(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];if(e&&t&&"object"===_typeof(e)&&"object"===_typeof(t)&&(n||r)){if(Array.isArray(e)){if(e.length!==t.length)return !1}else if(Object.keys(e).length!==Object.keys(t).length)return !1;for(var i in e)if(!isValueEqual(e[i],t[i],r,!1))return !1;return !0}return e===t}function watch(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if("function"==typeof e){e=computed(e);var o=t;t=function(e,t,r,n,i){isValueEqual(e,t)||o(e,t,r,n,i);};}else if(!isProxy(e))return e;return e[util]&&e[util].subscribe(t,r),e}function watchArray(e,t){e[trig]?e[trig].push(t):e[trig]=[t];}function createBinding(o,e){for(var t=0;t<e.length;t++){var r=e[t];isRef(r)||"function"==typeof r||(o[t]="".concat(o[t]).concat(r).concat(o[t+1]),o.splice(t+1,1),e.splice(t,1),t--);}if(0===e.length)return o[0];function n(r){var n=e.map(function(e){return "function"==typeof e?function(){return e()}:function(){return e.v}}),i=n.length;return watch(function(){for(var e=o[0],t=0;t<i;t++)e+=n[t]()+o[t+1];return e},function(e,t){r(e,t);},!1).v}return n[type]=AlinsType.BindResult,n}function react(e){if(isStringTemplateArray(e)){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return createBinding(e,r)}return createProxy(wrapReactive(e))}var SwitchResult,Renderer={createElement:function(e){e=document.createElement(e);return e[type]=AlinsType.Element,e},createTextNode:function(e){e=document.createTextNode(e);return e[type]=AlinsType.TextNode,e},createEmptyMountNode:function(){return document.createComment("")},createDocumentFragment:function(){return document.createDocumentFragment()},isFragment:function(e){return e instanceof DocumentFragment},isOriginElement:function(e){return e instanceof Node},isElement:function(e){return this.isFragment(e)||this.isOriginElement(e)}};function getFirstElement(e){return e?Renderer.isFragment(e)?e.firstChild:e:null}function getParent(e){return e.parentElement||e.parentNode||(1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)}function createAnchor(a){function c(){var e=f;if(e!==u){for(;e.nextSibling&&e.nextSibling!==u;)try{e.nextSibling.remove();}catch(e){console.error(e);break}e.remove();}f=u;}var l,u=null,f=null;return {getNodes:function(){for(var e=[],t=f;t&&t!==u;)e.push(t),t=t.nextSibling;return e},start:function(){return f},setStart:function(e){e&&(f=getFirstElement(e)||u);},replaceStart:function(e,t){getFirstElement(e)===f&&(f=getFirstElement(t));},replaceBranch:function(e){var t=e.current(),r=a.call(e);return console.log("branch debug:dom",r),e.inited?r?e.isVisible(t)&&(console.log("branch debug:replace 222"),this.replaceContent(r,e)):(console.log("branch debug:clearDom"),c(),e.updateActiveCache()):(e.inited=!0,console.log("branch debug:replace 111"),this.replaceContent(r,e)),r},replaceContent:function(t,e){if(!u||!f)return console.log("branch debug:replaceContent"),l=function(e){if(u=Renderer.createEmptyMountNode(),f=getFirstElement(e)||u,Renderer.isFragment(e))return e.appendChild(u),e;var t=Renderer.createDocumentFragment();return e&&t.appendChild(e),t.appendChild(u),t}(t);var r=getParent(u,l);if(r!==t){if(c(),!t)return null!=e&&e.updateActiveCache(),t;for(var n=getFirstElement(t),i=n||u,o=null==e?void 0:e.parent;o&&o.anchor.start()===f;)o.anchor.setStart(i),o.call&&a.modifyCache(o,n),o=o.parent;f=i,console.log("branch debug:container insert",r,f,u);try{r.insertBefore(t,u),null!=e&&e.updateActiveCache();}catch(e){console.error(e,r,t,u);}}return t},clearCache:function(){}}}function _if(e,t,i){console.log("branch debug:enter if",t.toString());function o(e){if(l===e)return !0;var t=c[l=e];return a.replaceBranch(t),console.warn("switch node",e),!1!==t.call.returned}function r(e){console.warn("if onDataChange",e);for(var t,r=e.length,n=0;n<r;n++)if(e[n])return (t=o(n))||n===r-1?t:o(r-1)}function n(e,t){var r=u,n=u++;c[n]=i.branch.next(t,a,2<arguments.length&&void 0!==arguments[2]&&arguments[2]),s[n]=e,f===empty&&("function"==typeof e?e():e.v)&&(n=i.cache.call(c[n],a),!1!==t.returned&&(l=r,f=n));}var a=createAnchor(i.cache),c=[],l=-1,u=0,f=empty,s=[],p=(n(e,t,!0),{elif:function(e,t){return n(e,t),p},else:function(e){return n(function(){return !0},e),p},end:function(){return n(function(){return !0},0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){}),watch(function(){return s.map(function(e){return "function"==typeof e?e():e.v})},r,!1),i.branch.back(),f!==empty?a.replaceContent(f):Renderer.createDocumentFragment()}});return p}function _switch(o,c,l){function u(e){var t=e.call,e=e.brk;if(t){t=y.get(t);if(!t)throw new Error("empty branch");t=p?l.cache.call(t,s):s.replaceBranch(t);if(t)return d=SwitchResult.Return,t}return d=e?SwitchResult.Break:SwitchResult.Continue,!!e}function a(e){var t,r,n=!1,i=(d=SwitchResult.Init,null),o=_createForOfIteratorHelper(c);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(n){if(i=u(a))break}else if((a.value===e||!("value"in a))&&(n=!0,i=u(a)))break}}catch(e){o.e(e);}finally{o.f();}return d!==SwitchResult.Return&&(r=y.get(f),i=p?l.cache.call(r,s):s.replaceBranch(r)),i}var f,s=createAnchor(l.cache),p=!0,y=new WeakMap,d=SwitchResult.Init;return {end:function(){f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};var e,t=watch(o,function(e){a(e);}),r=!0,n=_createForOfIteratorHelper(c);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.call&&(y.set(i.call,l.branch.next(i.call,s,r)),r=r&&!1);}}catch(e){n.e(e);}finally{n.f();}y.set(f,l.branch.next(f,s,r)),l.branch.back();t=a(t.v);return p=!1,Renderer.isElement(t)?s.replaceContent(t):Renderer.createDocumentFragment()}}}function map(a){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"$item",m=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",b=this;if(!e)return b.map(a);var A=Renderer.createDocumentFragment(),e=isProxy(b),t=b.length;if(e){function x(e,t){console.log("createChild",e,t);var r,n,e=_(e,t),i=a(e[g],e[m]||t),o=i;return i?Renderer.isFragment(i)?0===(n=(r=i.childNodes).length)?(o=Renderer.createEmptyMountNode(),i.appendChild(o),0===t&&(w=o)):(o=r[n-1],0===t&&(w=r[0])):0===t&&(w=i):(o=i=Renderer.createEmptyMountNode(),0===t&&(w=i)),console.log(w,t),[i,o,e]}for(var w,E=Renderer.createEmptyMountNode(),S=[],R=[],_=(b[util].scopeItems=R,b[util]._map=!0,R.key=g,function(e,t){e=createProxy({v:e},{shallow:!0});e=_defineProperty({},g,e);return m&&(e[m]=createProxy({v:t},{shallow:!0})),e}),r=0;r<t;r++){var n=b[r],n=_slicedToArray(x(n,r),3),i=n[0],o=n[1],n=n[2];R[r]=n,A.appendChild(i),S[r]=o;}watchArray(b,function(e){var t,n=e.index,r=e.count,i=e.data;switch(e.type){case OprateType.Push:for(var o=Renderer.createDocumentFragment(),a=b.length,c=0;c<i.length;c++){var l=_slicedToArray(x(i[c],a+c),3),u=l[0],f=l[1],l=l[2];S.push(f),R.push(l),o.appendChild(u);}getParent(E,A).insertBefore(o,E);break;case OprateType.Replace:R[n]?(console.warn("【debug: watch array replace2",n,JSON.stringify(i)),i[0]!==R[n][g].v&&(R[n][g].v=i[0]),m&&(R[n][m].v=n)):R[n]=_(i[0],n);break;case OprateType.Remove:if(0===r)break;for(var s=n-1,p=(null==(t=S[s+r])?void 0:t.nextSibling)||E,y=s<0?w||E:S[s];y.nextSibling&&y.nextSibling!==p;)y.nextSibling.remove();s<0&&(y!==E?(w=y.nextSibling,y.remove()):w=E),S.splice(n,r),R.splice(n,r);break;case OprateType.Insert:var d=0===n?w||E:S[n-1].nextSibling,v=[],h=[];i.forEach(function(e,t){var e=_slicedToArray(x(e,n+t),3),t=e[0],r=e[1],e=e[2];getParent(d,A).insertBefore(t,d),h.push(e),v.push(r);}),R.splice.apply(R,[n,0].concat(h)),S.splice.apply(S,[n,0].concat(v));}}),A.appendChild(E);}else for(var c=0;c<t;c++){var l=a(b[c],c);l&&A.appendChild(l);}return A}function isEventAttr(e,t,r){return !!t.startsWith("on")&&((null===e[t]||"function"==typeof e[t])&&("function"==typeof r||"function"==typeof(null==r?void 0:r.listener)||"string"==typeof(null==r?void 0:r.__deco)))}function addEvent(r,n,i){if(n=n.substring(2),"function"==typeof i)r.addEventListener(n,i);else {if(i.__deco){var e,t=i.__deco.split("-"),o=(i={listener:i.v},_createForOfIteratorHelper(t));try{for(o.s();!(e=o.n()).done;){var a=e.value;i[a]=!0;}}catch(e){o.e(e);}finally{o.f();}}r.addEventListener(n,function e(t){i.self&&t.target!==r||(i.stop&&t.stopPropagation(),i.prevent&&t.preventDefault(),i.once&&r.removeEventListener(n,e,i.capture),i.listener(t));},i.capture);}}function reactiveBindingEnable(e,i){var t="object"===_typeof(e)&&!isProxy(e)&&void 0!==e.enable,r=t?e.value:e,o=!0,a="",a=reactiveBinding(r,function(e,t,r,n){a=e,o&&i(e,t,r,n);});return t&&(o=watch(e.enable,function(e){i((o=e)?a:null,null,"","");}).v),i(o?a:null,void 0,"",""),a}function reactiveBindingValue(e,t){t(reactiveBinding(e,t),void 0,"","");}function reactiveClass(i,o){if(isRef(i)||"object"!==_typeof(i))return reactiveBinding(i,function(e){o("",e);});var e=function(){var e,r,t,n={};i.$value?(e=reactiveBinding(i.$value,function(e){var t,r=new Set([]);for(t in n)!0===n[t]&&r.add(t);e.split(" ").forEach(function(e){!1!==n[e]&&r.add(e);}),o("",Array.from(r).join(" "));}),r=new Set(e.split(" ")),delete i.$value):r=new Set([]);for(t in i)!function(t){r[(n[t]=!!reactiveBinding(i[t],function(e){n[t]=e,o(t,e);}))?"add":"delete"](t);}(t);return {v:Array.from(r).join(" ")}}();return "object"===_typeof(e)?e.v:void 0}function reactiveBinding(e,t){if("function"==typeof e||isProxy(e)&&void 0!==e.v)return watch(e,t).v;try{return "string"==typeof e?e:e.toString()}catch(e){throw new Error(e)}}function parseStyle(c,e){if(null==e)return !1;if("function"==typeof e||isProxy(e))reactiveBindingEnable(e,function(e,t,r,n,i){if("string"==typeof e)n&&"v"!==n?c.style[n]=i?"":e:c.setAttribute("style",e);else {for(var o in e)c.style[o]=e[o];for(var a in t)void 0===e[a]&&(c.style[a]="");}});else {if("object"!==_typeof(e))return !1;for(var t in e)!function(t){reactiveBindingEnable(e[t],function(e){c.style[t]=null===e?"":e;});}(t);}return !0}!function(e){e[e.Init=0]="Init",e[e.Break=1]="Break",e[e.Return=2]="Return",e[e.Continue=3]="Continue";}(SwitchResult=SwitchResult||{}),registArrayMap(map);var ModelTag={INPUT:1,SELECT:1,TEXTAREA:1};function parseModel(t,e,r){if("value"!==r&&"checked"!==r)return !1;if(!isProxy(e)&&!e.__deco)return !1;var n=t.tagName;if(!ModelTag[n])return !1;var i=e.__deco||_typeof(e.v),o=(o={boolean:function(e){return "true"===e},number:function(e){return parseFloat(e)},string:function(e){return e}}[i])||function(e){return e},a=e.__deco?e.v:e;return t.addEventListener("SELECT"===n?"change":"input",function(){var e=t[r];i!==_typeof(e)&&(e=o(e)),a.v=Number.isNaN(e)?"":e;}),watch(a,function(e){t[r]=e;},!1),t[r]=a.v,!0}function parseAttributes(y,e){if(null==e)return !1;if("function"==typeof e||isProxy(e))reactiveBindingEnable(e,function(e,t,r,n,i){if("string"==typeof e){if(n&&"v"!==n)return void(i?y.removeAttribute(n):y.setAttribute(n,e));var o,i=e.matchAll(/(.*?)=(.*?)(&|$)/g),a=(e={},_createForOfIteratorHelper(i));try{for(a.s();!(o=a.n()).done;){var c=o.value;e[c[1]]=c[2];}}catch(e){a.e(e);}finally{a.f();}var l,n=t.matchAll(/(.*?)=(.*?)(&|$)/g),u=(t={},_createForOfIteratorHelper(n));try{for(u.s();!(l=u.n()).done;){var f=l.value;t[f[1]]=f[2];}}catch(e){u.e(e);}finally{u.f();}}for(var s in e)y.setAttribute(s,e[s]);for(var p in t)void 0===e[p]&&y.removeAttribute(p);});else {if("object"!==_typeof(e))return !1;for(var t in e)!function(t){reactiveBindingEnable(e[t],function(e){null===e?y.removeAttribute(e):y.setAttribute(t,e);});}(t);}return !0}function transformOptionsToElement(r){if(r.isText)n=Renderer.createTextNode(""),""!==r.text&&reactiveBindingValue(r.text,function(e){n.textContent=e;});else {var e=!!r.tag,n=e?Renderer.createElement(r.tag):Renderer.createDocumentFragment();if(r.children&&appendChildren(n,r.children),e)for(var t in r.attributes)(function(t){var e=r.attributes[t];if(isEventAttr(n,t,e))return addEvent(n,t,e);if("$parent"===t)e.appendChild(n);else if("$attributes"===t)parseAttributes(n,e);else if("$show"===t)reactiveBindingEnable(e,function(e){n.style.display=e?"":"none";});else {if("class"!==t)return "style"===t&&parseStyle(n,e)||parseModel(n,e,t)||reactiveBindingEnable(e,function(e){null===e?n.removeAttribute(t):n.setAttribute(t,e);});n.className=reactiveClass(e,function(e,t){e?t?n.classList.add(e):n.classList.remove(e):n.className=t;});}})(t);}return n}function appendChildren(e,t){var r,n=_createForOfIteratorHelper(t);try{for(n.s();!(r=n.n()).done;){var i,o=r.value;if(null!=o){if(Array.isArray(o))return void appendChildren(e,o);Renderer.isElement(o)?e.appendChild(o):(i=transformOptionsToElement(isJSXElement(o)?o:{text:o,isText:!0}),e.appendChild(i));}}}catch(e){n.e(e);}finally{n.f();}}function isJSXElement(e){return "object"===_typeof(e)&&!0===e.jsx}var JSX={createElement:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length,n=new Array(2<r?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if("function"!=typeof e)return transformOptionsToElement({tag:e,attributes:t,children:n,jsx:!0});var o,a=t.$parent;for(o in delete t.$parent,t){var c=t[o];isProxy(c)||(t[o]={v:c});}var l=transformAsyncDom(e(t,n));return a&&a.appendChild(l),l}};function transformAsyncDom(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=2<arguments.length?arguments[2]:void 0;if(e&&e instanceof Promise){if(!1===t)return;var n=Renderer.createDocumentFragment(),i=Renderer.createEmptyMountNode();return n.appendChild(i),e.then(function(e){if(Renderer.isElement(e)){var t=getParent(i,n);try{t.insertBefore(e,i);}catch(e){console.log("node 已被隐藏");}finally{null!=r&&r(e),i.remove();}}}),n}return e}function transformElementToCache(e){return e?Renderer.isFragment(e)?Array.from(e.childNodes):Array.isArray(e)?e:[e]:null}function transformCacheToElement(e){if(!e)return null;if(1===e.length)return e[0];var t,r=Renderer.createDocumentFragment(),n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.appendChild(i);}}catch(e){n.e(e);}finally{n.f();}return r}function createCallCache(){var c=new WeakMap;return {call:function(t,r){var n=this,e=(t.visit(),t.call),i=c.get(e);if(console.log("branch debug:item",t.id,i),void 0!==i)return transformCacheToElement(i);var o,a,i=e();if(!1===e.returned?o=transformAsyncDom(i,!1):a=getFirstElement(o=transformAsyncDom(i,!(a=null),function(e){n.modifyCache(t,e),null!=r&&r.replaceStart(a,e),a=null;})),Renderer.isElement(o)||void 0===o)return this.modifyCache(t,o),o;throw new Error("动态条件分支中不允许返回非元素类型")},modifyCache:function(e,t){e.call&&(t=transformElementToCache(t),console.log("branch debug: cacheMap set",e.id,t),c.set(e.call,t));},setCache:function(e,t){c.set(e,t);},_get:function(e){return c.get(e)}}}function createBranchLink(i,e){console.log("createBranchLink");var o=[],a=0,c={anchor:e,parent:null},l=null,u=null,f=!1;return {next:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=function(e,r){var t=0===o.length?c:o[o.length-1],t=2<arguments.length&&void 0!==arguments[2]&&arguments[2]?t:null==t?void 0:t.parent;return {id:a++,call:e,parent:t,activeChild:null,anchor:r,current:function(){return l},isVisible:function(e){if(!u){u=new WeakMap;for(var t=e||l,r=[];t;)r.push(t.id),u.set(t,1),t=t.parent;console.log("branch debug:branchpath",r.toString());}if(!!u.get(this))return !0;var n=this.parent;if(!n||u.get(n))return !0;for(;n;){if(!!u.get(n))break;n=n.parent;}return !1},visit:function(){l!==this&&(f&&(o=[this]),(l=this).parent&&(this.parent.activeChild=this),u=null);},updateCache:function(){var e,t=r.getNodes();console.log("branch debug: updateCache",this.id,t),i.setCache(this.call,t),null!=(e=null==(t=this.parent)?void 0:t.updateCache)&&e.call(t);},updateActiveCache:function(){var e,t;null!=(t=null==(e=this.getBottomChild().parent)?void 0:e.updateCache)&&t.call(e);},clearCache:function(){},getBottomChild:function(){for(var e=this;e.activeChild;)e=e.activeChild;return e}}}(e,t,r);return r?o.push(n):o[o.length-1]=n,console.warn("branch debug:next:".concat(n.id,":").concat(r),n.call.toString()),n},back:function(){console.warn("branch:back");var e=o.pop();return 0===o.length&&(f=!0),e}}}function createContext(){var e=createCallCache(),t=createAnchor(e),r={anchor:t,cache:e,branch:createBranchLink(e,t)};return {util:r,if:function(e,t){return _if(e,t,r)},switch:function(e,t){return _switch(e,t,r)}}}var ContextTool={ce:JSX.createElement,mnr:function(e){return e.returned=!1,e},r:react,c:computed,w:watch,cc:function(e,t){return computed({get:e,set:t})}};Object.assign(createContext,ContextTool);

    window._$$ = createContext;
    let count = createContext.r({
      v: 1
    });
    createContext.ce("button", {
      $parent: document.body,
      onclick: () => {
        count.v++;
      }
    }, "click:", count);

})();
